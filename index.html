<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Monstrosity Through Music</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="stylesheet" href="https://use.typekit.net/cwf5imh.css">
  </head>
  <body>
    <h1 id="title">Monstrosity Through Music</h1>
    <div style="width: 960px; margin: auto;">
      <p><b>A comprehensive visualization of my top sixteen songs from Spotify.</b></p>

      <p>Use the right mouse button to orbit around the scene.</p>
      <p>Click on a visual to zoom in and learn more about the song.</p>
      <p>Use the slider on the right to adjust the volume (ensure that the browser is unmuted!).</p>
    </div>
    
    <div id="unity-parent">
      <div id="unity-container" class="unity-desktop">
        <canvas id="unity-canvas" width=960 height=600></canvas>
        <div id="unity-loading-bar">
          <div id="spotify-logo"></div>
          <div id="unity-progress-bar-empty">
            <div id="unity-progress-bar-full"></div>
          </div>
        </div>
        <div id="unity-mobile-warning">
          WebGL builds are not supported on mobile devices.
        </div>
        <div id="unity-footer">
          <div id="unity-fullscreen-button"></div>
        </div>
      </div>
    </div>

    <div id="data-container" class="row">
      <h1 id="data">101,521 <span id="bigtext">minutes listened.</span> 39,071 <span id="bigtext">song plays.</span> 4.6 <span id="bigtext">hours listened daily.</span></h1>
      <div>
        <div class="column">
          <h1 id="subtitle">What is this?</h1>
          <p>A collection of my top songs from the past year, featuring data collected between 4/14/2020 and 4/13/2021. Each song is represented
            by a 10-15 second selection of the chorus, along with accomanying visuals that demonstrate the audio spectrum. It was created for FRS 174,
            a freshman seminar at Princeton University.
          </p>
          <h1 id="subtitle">Why does it exist?</h1>
          <p>I wanted to create a comprehensive visualization of my "taste in music". This mainly included creating a way to "listen" to all of my top songs at once, and it's clear
            that simply playing them all at the same time would be disastrous and extremely overwhelming. So I created this, representing each song by a comprehensive visual
            analyzing the individual spectral component of the piece. Upon listening, information would become available to explain how important this song was to my interests in music.
            The goal was to create a <i>minimal</i>, yet appealing display for my music, and I believe this project fulfills that goal perfectly.
          </p>
        </div>
        <div class="column">
          <h1 id="subtitle">How was it made?</h1>
          <p>It was made with Unity3D and C#.
          </p>
          <h1 id="subtitle">Where did this data come from?</h1>
          <p>Spotify allows its users to request a download of all data collected on them in the past year. More info can be found linked
            <a href="https://support.spotify.com/us/article/data-rights-and-privacy-settings/">here</a>. It's a simple process and contains a surprising
            amount of information. It is definitely worth taking a look if you have a Spotify account.     
          </p>
        </div>
      </div>
    </div>

    

    <script>
      var buildUrl = "Build";
      var loaderUrl = buildUrl + "/monsters-vis.loader.js";
      var config = {
        dataUrl: buildUrl + "/monsters-vis.data",
        frameworkUrl: buildUrl + "/monsters-vis.framework.js",
        codeUrl: buildUrl + "/monsters-vis.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Scornz",
        productName: "Data Roam",
        productVersion: "0.1",
      };

      var container = document.querySelector("#unity-container");
      var canvas = document.querySelector("#unity-canvas");
      var loadingBar = document.querySelector("#unity-loading-bar");
      var progressBarFull = document.querySelector("#unity-progress-bar-full");
      var fullscreenButton = document.querySelector("#unity-fullscreen-button");
      var mobileWarning = document.querySelector("#unity-mobile-warning");

      // By default Unity keeps WebGL canvas render target size matched with
      // the DOM size of the canvas element (scaled by window.devicePixelRatio)
      // Set this to false if you want to decouple this synchronization from
      // happening inside the engine, and you would instead like to size up
      // the canvas DOM size and WebGL render target sizes yourself.
      // config.matchWebGLToCanvasSize = false;

      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
        // Avoid draining fillrate performance on mobile devices,
        // and default/override low DPI mode on mobile browsers.
        config.devicePixelRatio = 1;
        mobileWarning.style.display = "block";
        setTimeout(() => {
          mobileWarning.style.display = "none";
        }, 5000);
      } else {
        canvas.style.width = "960px";
        canvas.style.height = "600px";
      }
      loadingBar.style.display = "block";

      var script = document.createElement("script");
      script.src = loaderUrl;
      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
          progressBarFull.style.width = 100 * progress + "%";
        }).then((unityInstance) => {
          loadingBar.style.display = "none";
          fullscreenButton.onclick = () => {
            unityInstance.SetFullscreen(1);
          };
        }).catch((message) => {
          alert(message);
        });
      };
      document.body.appendChild(script);
    </script>
    <script type='text/javascript'>
      /*
      WebGLInject - Part of Simple Spectrum V2.1 by Sam Boyer.
      */
      
      window.SimpleSpectrum = {};
      
      window.AudioContext = (function(){
        var ACConsructor = window.AudioContext || window.webkitAudioContext; //keep a reference to the original function
        
        //console.log('AudioContext Constructor overriden');
          
        return function(){
          var ac = new ACConsructor();
      
          //console.log('AudioContext constructed');
          
          window.SimpleSpectrum.ac = ac;
      
          window.SimpleSpectrum.a = ac.createAnalyser();
          window.SimpleSpectrum.a.smoothingTimeConstant = 0;
            
          window.SimpleSpectrum.fa = new Uint8Array(window.SimpleSpectrum.a.frequencyBinCount); //frequency array, size of frequencyBinCount
            
          window.SimpleSpectrum.la = new Uint8Array(window.SimpleSpectrum.a.fftSize); //loudness array, size of fftSize
            
          window.SimpleSpectrum.a.connect(ac.destination); //connect the AnalyserNode to the AudioContext's destination.
            
          ac.actualDestination = ac.destination; //keep a reference to the destination.
            
          Object.defineProperty(ac, 'destination', { //replace ac.destination with our AnalyserNode.
            value: window.SimpleSpectrum.a,
            writable: false
          });		
            
          return ac; //send our modified AudioContext back to Unity.
        }
      })();
      </script>
  </body>
</html>
